<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Peel Corner - Attach to Any Div (Test)</title>

		<style>
			:root {
				/* === 1. é¢œè‰²é…ç½® === */
				--bg-page: #ffffff;
				--bg-peel: linear-gradient(135deg, #fffff0 0%, #fff9c4 100%);
				--shadow-peel: -5px 5px 15px rgba(0, 0, 0, 0.15);
				--text-color: #333333;

				/* === 2. å°ºå¯¸é…ç½® === */
				--size-idle: 50px;
				/* çŠ¶æ€ä¸€ */
				--size-open: 140px;
				/* çŠ¶æ€äºŒ */
				--size-active: 155px;
				/* çŠ¶æ€ä¸‰ */

				/* === 3. åŠ¨ç”»æ›²çº¿ === */
				--ease-bounce: cubic-bezier(0.175, 0.885, 0.32, 1.275);
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
				-webkit-tap-highlight-color: transparent;
			}

			body {
				background: var(--bg-page);
				font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", Helvetica, Arial, sans-serif;
				min-height: 100vh;
				display: grid;
				place-items: center;
				padding: 28px;
				color: #111;
			}

			/* ============ æµ‹è¯•å¸ƒå±€ ============ */
			.grid {
				width: min(1100px, 100%);
				display: grid;
				grid-template-columns: repeat(12, 1fr);
				gap: 18px;
			}

			.card {
				background: #f9f9f9;
				border: 1px solid #eee;
				border-radius: 18px;
				padding: 18px;
				min-height: 260px;
				box-shadow: 0 10px 24px rgba(0, 0, 0, 0.06);
			}

			.card h2 {
				font-size: 16px;
				margin-bottom: 6px;
				letter-spacing: 0.2px;
			}

			.card p {
				font-size: 13px;
				color: #666;
				line-height: 1.6;
			}

			.span-6 {
				grid-column: span 6;
			}

			.span-4 {
				grid-column: span 4;
			}

			.span-8 {
				grid-column: span 8;
			}

			@media (max-width: 900px) {

				.span-6,
				.span-4,
				.span-8 {
					grid-column: span 12;
				}
			}

			/* éšè— checkboxï¼ˆæ¯ä¸ªå¡ç‰‡ä¸€å¥—ï¼‰ */
			.toggle-state {
				display: none;
			}

			/* ç®€å•çš„çŠ¶æ€åˆ‡æ¢æ˜¾ç¤º */
			.view-v1,
			.view-v2 {
				display: none;
			}

			.toggle-state:not(:checked)~.content .view-v1 {
				display: block;
			}

			.toggle-state:checked~.content .view-v2 {
				display: block;
			}

			/* =====================================================
       âœ… å…³é”®ï¼šè®©ä»»æ„ div å³ä¸Šè§’å¯æŒ‚æŠ˜é¡µ
       ç”¨æ³•ï¼šå®¹å™¨åŠ  .peel-hostï¼ŒæŠ˜é¡µ label æ”¾è¿›å®¹å™¨å³å¯
       ===================================================== */
			.peel-host {
				position: relative;
				/* ç»å¯¹å®šä½å‚ç…§ */
				overflow: hidden;
				/* ä¸è®©æŠ˜é¡µæº¢å‡ºï¼›æƒ³éœ²å‡ºå»å°±æ”¹ visible */
			}

			.peel-host>.peel-corner {
				position: absolute;
				top: 0;
				right: 0;
				z-index: 50;
				cursor: pointer;
				user-select: none;

				width: var(--size-idle);
				height: var(--size-idle);

				transition: width 0.4s var(--ease-bounce), height 0.4s var(--ease-bounce);
			}

			/* æŠ˜é¡µæœ¬ä½“ */
			.peel-host>.peel-corner .peel-shape {
				position: absolute;
				inset: 0;
				background: var(--bg-peel);
				border-bottom-left-radius: 100%;
				box-shadow: var(--shadow-peel);
				pointer-events: none;
			}

			.peel-host>.peel-corner .peel-shape::after {
				content: "";
				position: absolute;
				inset: 0;
				border-bottom-left-radius: 100%;
				background: linear-gradient(135deg, rgba(255, 255, 255, 0.8) 0%, transparent 60%);
			}

			/* å†…å®¹å®¹å™¨ï¼ˆå›¾æ ‡ + æ–‡å­—ï¼‰ */
			.peel-host>.peel-corner .widget-position {
				position: absolute;
				top: 0;
				right: 0;
				z-index: 2;
				opacity: 1;
				transform: scale(0.45) rotate(15deg);
				transition: all 0.3s var(--ease-bounce);
			}

			.peel-host>.peel-corner .widget-content {
				position: absolute;
				width: 100%;
				height: 100%;
				right: 2rem;
				top: 4rem;
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
			}

			.peel-host>.peel-corner .widget-icon {
				width: 40px;
				height: 40px;
				border-radius: 10px;
				margin-bottom: 6px;
				object-fit: cover;
				box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			}

			.peel-host>.peel-corner .widget-text {
				font-size: 12px;
				transform: scale(0);
				font-weight: 700;
				color: var(--text-color);
				text-transform: uppercase;
				letter-spacing: 0.5px;
				transition: all 0.3s var(--ease-bounce);
			}

			/* åŠ¨æ€åˆ‡æ¢å†…å®¹é€»è¾‘ (V1 <-> V2) */
			.show-v1,
			.show-v2 {
				display: none;
			}

			.toggle-state:not(:checked)~.peel-corner .show-v2 {
				display: block;
			}

			.toggle-state:checked~.peel-corner .show-v1 {
				display: block;
			}

			/* =========================================
       åªå†™ä¸¤ä¸ª @mediaï¼šç”µè„‘/æ‰‹æœºï¼Œåˆ†ç•Œ 600px
       ========================================= */

			/* ğŸ–¥ï¸ ç”µè„‘ç«¯ (>= 600px)ï¼šhover å±•å¼€ */
			@media (min-width: 600px) {
				.peel-host>.peel-corner:hover {
					width: var(--size-open);
					height: var(--size-open);
				}

				.peel-host>.peel-corner:hover .widget-position {
					transform: scale(1) rotate(15deg);
				}

				.peel-host>.peel-corner:hover .widget-text {
					transform: scale(1);
				}

				/* æ¡Œé¢æŒ‰å‹æ€ï¼ˆå¯é€‰ï¼Œä½“éªŒæ›´çˆ½ï¼‰ */
				.peel-host>.peel-corner:active {
					width: var(--size-active);
					height: var(--size-active);
					transition-duration: 0.1s;
				}

				.peel-host>.peel-corner:active .widget-content {
					transform: scale(0.92);
					transition-duration: 0.1s;
				}
			}

			/* ğŸ“± æ‰‹æœºç«¯ (< 600px)ï¼šJS æ§åˆ¶ is-open / is-activeï¼Œæ•´ä½“ç¼© 25% */
			@media (max-width: 599px) {
				:root {
					--m-scale: 0.75;
				}

				/* çŠ¶æ€ä¸€ï¼šæ”¶èµ· */
				.peel-host>.peel-corner {
					width: calc(var(--size-idle) * var(--m-scale));
					height: calc(var(--size-idle) * var(--m-scale));
				}

				/* çŠ¶æ€äºŒï¼šå±•å¼€ */
				.peel-host>.peel-corner.is-open {
					width: calc(var(--size-open) * var(--m-scale));
					height: calc(var(--size-open) * var(--m-scale));
				}

				/* çŠ¶æ€ä¸‰ï¼šæŒ‰å‹ */
				.peel-host>.peel-corner.is-active {
					width: calc(var(--size-active) * var(--m-scale));
					height: calc(var(--size-active) * var(--m-scale));
					transition-duration: 0.1s;
				}

				/* å†…å®¹æ•´ä½“ç¼©æ”¾ï¼ˆå›¾æ ‡+æ–‡å­—ä¸€èµ·å° 25%ï¼‰ */
				.peel-host>.peel-corner .widget-position {
					transform: scale(calc(0.45 * var(--m-scale))) rotate(15deg);
				}

				.peel-host>.peel-corner.is-open .widget-position {
					transform: scale(var(--m-scale)) rotate(15deg);
				}

				/* æ–‡å­—æ˜¾ç¤º/éšè— */
				.peel-host>.peel-corner .widget-text {
					transform: scale(0);
				}

				.peel-host>.peel-corner.is-open .widget-text {
					transform: scale(1);
				}

				/* å†…å®¹ä½ç½®åŒæ­¥ç¼©æ”¾ */
				.peel-host>.peel-corner .widget-content {
					right: calc(2rem);
					top: calc(4rem);
				}

				/* æŒ‰å‹åé¦ˆ */
				.peel-host>.peel-corner.is-active .widget-content {
					transform: scale(0.92);
				}
			}
		</style>
	</head>

	<body>
		<div class="grid">
			<!-- å¡ç‰‡ Aï¼šç‹¬ç«‹ toggle -->
			<div class="card peel-host span-6" id="cardA">
				<input class="toggle-state" type="checkbox" id="toggle-a" />

				<label class="peel-corner" for="toggle-a" aria-label="Toggle A">
					<span class="peel-shape"></span>

					<span class="widget-position">
						<span class="widget-content">
							<img src="https://picsum.photos/id/10/100/100" class="widget-icon show-v2" alt="Go V2" />
							<img src="https://picsum.photos/id/20/100/100" class="widget-icon show-v1"
								alt="Back Home" />
							<span class="widget-text show-v2">Switch</span>
							<span class="widget-text show-v1">Back</span>
						</span>
					</span>
				</label>

				<div class="content">
					<div class="view-v1">
						<h2>å¡ç‰‡ A Â· çŠ¶æ€ V1</h2>
						<p>è¿™ä¸ªæŠ˜é¡µæŒ‚åœ¨ã€Œä»»æ„ divã€å³ä¸Šè§’ï¼šåªè¦ div åŠ  <code>.peel-host</code>ï¼ŒæŠ˜é¡µ label æ”¾è¿›å»å°±è¡Œã€‚</p>
					</div>
					<div class="view-v2">
						<h2>å¡ç‰‡ A Â· çŠ¶æ€ V2</h2>
						<p>åˆ‡æ¢æˆåŠŸ âœ…ï¼ˆcheckbox æ§åˆ¶å†…å®¹ï¼‰ã€‚æ‰‹æœºç«¯è‡ªåŠ¨æ¼”ç¤ºèŠ‚å¥ + t3 å›æ”¶é€»è¾‘è§ JSã€‚</p>
					</div>
				</div>
			</div>

			<!-- å¡ç‰‡ Bï¼šç‹¬ç«‹ toggle -->
			<div class="card peel-host span-6" id="cardB">
				<input class="toggle-state" type="checkbox" id="toggle-b" />

				<label class="peel-corner" for="toggle-b" aria-label="Toggle B">
					<span class="peel-shape"></span>

					<span class="widget-position">
						<span class="widget-content">
							<img src="https://picsum.photos/id/30/100/100" class="widget-icon show-v2" alt="Go V2" />
							<img src="https://picsum.photos/id/40/100/100" class="widget-icon show-v1"
								alt="Back Home" />
							<span class="widget-text show-v2">Next</span>
							<span class="widget-text show-v1">Home</span>
						</span>
					</span>
				</label>

				<div class="content">
					<div class="view-v1">
						<h2>å¡ç‰‡ B Â· çŠ¶æ€ V1</h2>
						<p>è¿™æ˜¯ç¬¬äºŒä¸ªå®¹å™¨ï¼Œè¯æ˜å¯ä»¥åŒæ—¶æŒ‚å¤šä¸ªæŠ˜è§’ï¼Œå„è‡ªç‹¬ç«‹è®¡æ—¶ã€ç‹¬ç«‹æ§åˆ¶ã€‚</p>
					</div>
					<div class="view-v2">
						<h2>å¡ç‰‡ B Â· çŠ¶æ€ V2</h2>
						<p>ä½ å¯ä»¥æŠŠè¿™å¥—ç”¨åœ¨ä½œå“å¡ç‰‡ã€åº”ç”¨å¡ç‰‡ã€ä»»æ„æ¨¡å—å³ä¸Šè§’ã€‚</p>
					</div>
				</div>
			</div>

			<!-- é¢å¤–æµ‹è¯•ï¼šä¸åŒå°ºå¯¸å®¹å™¨ -->
			<div class="card peel-host span-4" id="cardC" style="min-height: 200px;">
				<input class="toggle-state" type="checkbox" id="toggle-c" />
				<label class="peel-corner" for="toggle-c" aria-label="Toggle C">
					<span class="peel-shape"></span>
					<span class="widget-position">
						<span class="widget-content">
							<img src="https://picsum.photos/id/50/100/100" class="widget-icon show-v2" alt="" />
							<img src="https://picsum.photos/id/60/100/100" class="widget-icon show-v1" alt="" />
							<span class="widget-text show-v2">Go</span>
							<span class="widget-text show-v1">Back</span>
						</span>
					</span>
				</label>

				<div class="content">
					<div class="view-v1">
						<h2>å°å¡ç‰‡ Â· V1</h2>
						<p>å®¹å™¨æ›´å°ä¹Ÿèƒ½æŒ‚ã€‚</p>
					</div>
					<div class="view-v2">
						<h2>å°å¡ç‰‡ Â· V2</h2>
						<p>OK âœ…</p>
					</div>
				</div>
			</div>

			<div class="card span-8" style="background:#fff;border:1px dashed #e5e5e5;">
				<h2>å¯¹ç…§åŒºï¼ˆæ— æŠ˜è§’ï¼‰</h2>
				<p>è¿™ä¸ªå¡ç‰‡æ²¡æœ‰ <code>.peel-host</code>ï¼Œä¹Ÿæ²¡æœ‰æŠ˜è§’ç»„ä»¶ã€‚</p>
			</div>
		</div>

		<script>
			(function() {
				// âœ… ç”¨åˆ†è¾¨ç‡åšæ‰‹æœºåˆ¤å®šï¼ˆä¸ 600px åˆ†ç•Œä¸€è‡´ï¼‰
				const isMobile = window.matchMedia && window.matchMedia("(max-width: 599px)").matches;
				if (!isMobile) return;

				// è®©é¡µé¢å¤šä¸ªæŠ˜è§’å„è‡ªç‹¬ç«‹å·¥ä½œ
				const corners = document.querySelectorAll(".peel-host > .peel-corner");
				if (!corners.length) return;

				// ========== é…ç½® ==========
				const OPEN_AFTER = 3000; // åˆå§‹æ— æ“ä½œï¼šå¤šä¹…åè‡ªåŠ¨å±•å¼€ï¼ˆçŠ¶æ€äºŒï¼‰
				const CLOSE_AFTER = 1500; // åˆå§‹å±•å¼€åï¼šå¤šä¹…åè‡ªåŠ¨æ”¶èµ·ï¼ˆå›çŠ¶æ€ä¸€ï¼‰
				const T3_AFTER = 300; // äº¤äº’åï¼šå¤šä¹…æ— æ“ä½œè‡ªåŠ¨å›çŠ¶æ€ä¸€ï¼ˆt3ï¼‰

				corners.forEach((corner) => {
					// æ¯ä¸ª corner è‡ªå·±çš„è®¡æ—¶å™¨ä¸çŠ¶æ€
					let t1 = null,
						t2 = null,
						t3 = null;
					let touched = false;

					function clearTimers() {
						clearTimeout(t1);
						clearTimeout(t2);
						clearTimeout(t3);
						t1 = t2 = t3 = null;
					}

					function toIdle() {
						corner.classList.remove("is-open");
						corner.classList.remove("is-active");
					}

					function toOpen() {
						corner.classList.add("is-open");
						corner.classList.remove("is-active");
					}

					function toActive() {
						corner.classList.add("is-active");
					}

					function startAutoSequence() {
						clearTimers();
						toIdle();

						t1 = setTimeout(() => {
							if (touched) return;
							toOpen();

							t2 = setTimeout(() => {
								if (touched) return;
								toIdle();
							}, CLOSE_AFTER);
						}, OPEN_AFTER);
					}

					function scheduleReturnToIdle() {
						clearTimeout(t3);
						t3 = setTimeout(() => {
							toIdle();
						}, T3_AFTER);
					}

					function onDown() {
						touched = true;
						clearTimers();
						toOpen();
						toActive();
					}

					function onUp() {
						corner.classList.remove("is-active");
						scheduleReturnToIdle();
					}

					function onClick() {
						touched = true;
						toOpen();
						scheduleReturnToIdle();
					}

					// åˆå§‹åŒ–
					startAutoSequence();

					corner.addEventListener("pointerdown", onDown, {
						passive: true
					});
					corner.addEventListener("pointerup", onUp, {
						passive: true
					});
					corner.addEventListener("pointercancel", onUp, {
						passive: true
					});
					corner.addEventListener("click", onClick);
				});
			})();
		</script>
	</body>
</html>